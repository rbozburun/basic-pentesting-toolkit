#!/usr/bin/python3

import re
import argparse
import requests
from time import sleep
import io

def isIncludeLoginKeyword(text):
    login_keywords = re.compile("Giriş|Kullanıcı Adı|Parola|Doğrulama Kodu|Yönetim Paneli|Login|Log in|log in|Log In|log In|LOG IN|login|LOGIN|Giriş|Giris|giris|GİRİS|GIRIS|GİRİŞ|Kayıt Ol|Kayıt ol|Kaydol|kayıt ol|KAYIT O|kaydol|KAYDOL|oturum ac|OTURUM AÇ|Oturum Aç|oturum aç|Oturum Ac|Submit|submit|SUBMIT|SUBMİT|submıt|Submıt")

    if "<input" in text:
        if login_keywords.search(text):
            return True
    return False

def main():
    parser = argparse.ArgumentParser(description="Login page finder.")
    parser.add_argument('-f','--url_file', help="URL list file.")
    args = parser.parse_args()
    url_file = args.url_file

    f = open(url_file,'r')
    urls = f.readlines()

    for url in urls:
        url = url[:-1]
        print("[!] Trying for: {0}".format(url))
        try:
            url_text = get_response(url)
        except Exception as e:
            print("|_> URL request error, passing the next one...")
            
        else:
            if  isIncludeLoginKeyword(url_text):
                print("[+] {0}".format(url))
                with open("login_urls.txt","a") as out_f:
                    out_f.write(url+"\n")

    f.close()
    out_f.close()


def get_response(url):
    resp = requests.get(url, allow_redirects=True, timeout=7)
    return str(resp.content)
    

if __name__ == "__main__":
    main()