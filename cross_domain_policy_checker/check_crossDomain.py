#!/usr/bin/python3

import re
import argparse
import requests
from time import sleep
import xmltodict



def main():
    parser = argparse.ArgumentParser(description="Cross domain policy controller.")
    parser.add_argument('-f','--url_file', help="URL list file.")
    args = parser.parse_args()
    url_file = args.url_file

    f = open(url_file,'r')
    urls = f.readlines()
    f.close()

    for url in urls:
        url = url[:-1] + "/crossdomain.xml"
        print("[!] Checking Cross Domain Policy for: {0}".format(url))
        try:
            resp = requests.get(url, timeout=7, allow_redirects=False)
            xml = resp.content
        except Exception as e:
            print("|_> URL request error, passing the next one...")
        else:
            if resp.status_code == requests.codes.ok:
                try:
                    if "cross-domain-policy" in xml:
                        print("[+] crossdomain.xml found: {0}".format(url))
                except Exception as e:
                    print(e)
                    print(url)
                    print(xml)

    

    

if __name__ == "__main__":
    main()